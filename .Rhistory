knitr::opts_chunk$set(echo = TRUE)
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(#DataExplorer, # For explorer and cleaning data by visualizing missing values.
gptstudio,#For coding assistance
httr, # For downloading the data from the UCI
tidyverse, # For data manipulation
sjPlot,
corrplot, # for heatmaps
DataExplorer, #for exploring data
skimr # for nice summary of data
) # For creating dummy variables of categorical variables automatically.)
sessionInfo()
# Install and load necessary packages
install.packages("readxl")
install.packages("dplyr")
library(readxl)
library(dplyr)
# Read Excel files
file1 <- read.csv("Attributes.csv")
file1 = file1 %>% select(-`X`)
file2 <- read.csv("BA_Majors.csv")
file2 = file2 %>% select(-`X`)
# Combine data frames
merged_data <- merge(file1, file2, by = c("Student.ID", "Term.Code"))
# Write combined data frame to a new Excel file
saveRDS(merged_data, "StudentData")
count_table <- file1 %>%
group_by(Term.Code) %>%
summarise(DistinctStudentCount = n_distinct(Student.ID))
# Print the new table
print(count_table)
install.packages("dplyr")
knitr::opts_chunk$set(echo = TRUE)
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(#DataExplorer, # For explorer and cleaning data by visualizing missing values.
gptstudio,#For coding assistance
httr, # For downloading the data from the UCI
tidyverse, # For data manipulation
sjPlot,
corrplot, # for heatmaps
DataExplorer, #for exploring data
skimr # for nice summary of data
) # For creating dummy variables of categorical variables automatically.)
minors <- read.csv("BA Major Students - Minors.csv")
minors <- read.csv("BA Major Students - Minors.csv")
library(readxl)
BA_Major_Students_Minors <- read_excel("BA Major Students - Minors.xlsx")
View(BA_Major_Students_Minors)
minors <- read_excel("BA Major Students - Minors.xlsx")
#merged_data <- merge(merged_data, minors, by = c("Student.ID", "Term.Code"))
#inors = minors %>% select(-`X`)
minors <- read_excel("BA Major Students - Minors.xlsx")
minors <- minors %>% rename(`Student ID` = Student.ID, `Term Code` = Term.Code, `Cohort Term` = Cohort.Term)
minors <- read_excel("BA Major Students - Minors.xlsx")
minors <- minors %>% rename(Student.ID = `Student ID`, Term.Code = `Term Code`, Cohort.Term = `Cohort Term`)
minors = minors %>% select(-`Enrolled Student Count`)
merged_data <- merge(merged_data, minors, by = c("Student.ID", "Term.Code"))
View(merged_data)
# Read Excel files
file1 <- read.csv("Attributes.csv")
file1 = file1 %>% select(-`X`)
file2 <- read.csv("BA_Majors.csv")
file2 = file2 %>% select(-`X`)
# Combine data frames
merged_data <- merge(file1, file2, by = c("Student.ID", "Term.Code"))
# Write combined data frame to a new Excel file
saveRDS(merged_data, "StudentData")
count_table <- file1 %>%
group_by(Term.Code) %>%
summarise(DistinctStudentCount = n_distinct(Student.ID))
# Print the new table
print(count_table)
minors <- read_excel("BA Major Students - Minors.xlsx")
minors <- minors %>% rename(Student.ID = `Student ID`, Term.Code = `Term Code`, Cohort.Term = `Cohort Term`)
minors = minors %>% select(-`Enrolled Student Count`)
merged_data <- merge(merged_data, minors, by = c("Student.ID", "Term.Code"), all.x = TRUE)
View(merged_data)
# Read Excel files
file1 <- read.csv("Attributes.csv")
file1 = file1 %>% select(-`X`)
file2 <- read.csv("BA_Majors.csv")
file2 = file2 %>% select(-`X`)
# Combine data frames
merged_data <- merge(file1, file2, by = c("Student.ID", "Term.Code"))
# Write combined data frame to a new Excel file
saveRDS(merged_data, "StudentData")
minors <- read_excel("BA Major Students - Minors.xlsx")
minors <- minors %>% rename(Student.ID = `Student ID`, Term.Code = `Term Code`, Cohort.Term = `Cohort Term`)
minors = minors %>% select(-`Enrolled Student Count`)
merged_data <- merge(merged_data, minors, by = c("Student.ID", "Term.Code"), all.x = TRUE, all.y = TRUE)
merged_data = merged_data %>% select(-`Cohort.Term.y`)
library(readxl)
BA_Major_Students_Thematic_Sequence_ISA2 <- read_excel("BA Major Students - Thematic Sequence ISA2.xlsx")
View(BA_Major_Students_Thematic_Sequence_ISA2)
thematic <- read_excel("BA_Major_Students_Thematic_Sequence_ISA2.xlsx")
View(BA_Major_Students_Thematic_Sequence_ISA2)
View(BA_Major_Students_Thematic_Sequence_ISA2)
thematic <- read_excel("BA Major Students - Thematic Sequence ISA2.xlsx")
thematic <- thematic %>% rename(Student.ID = `Student ID`, Term.Code = `Term Code`, Thematic.Sequence.Title = `Thematic Sequence Title`)
thematic = thematic %>% select(-`Enrolled Student Count`)
merged_data <- merge(merged_data, thematic, by = c("Student.ID", "Term.Code"), all.x = TRUE, all.y = TRUE)
merged_data <- merged_data %>% group_by(Student.ID) %>% mutate (Flag = ifelse(n() < 8 & tail(Term.Code, 1) != '202410', 1,0)) %>% ungroup()
View(merged_data)
merged_data$Flag = 1
# Read Excel files
file1 <- read.csv("Attributes.csv")
file1 = file1 %>% select(-`X`)
file2 <- read.csv("BA_Majors.csv")
file2 = file2 %>% select(-`X`)
# Combine data frames
merged_data <- merge(file1, file2, by = c("Student.ID", "Term.Code"))
# Write combined data frame to a new Excel file
saveRDS(merged_data, "StudentData")
count_table <- merged_data %>%
group_by(Term.Code) %>%
summarise(DistinctStudentCount = n_distinct(Student.ID))
# Print the new table
print(count_table)
minors <- read_excel("BA Major Students - Minors.xlsx")
minors <- minors %>% rename(Student.ID = `Student ID`, Term.Code = `Term Code`, Cohort.Term = `Cohort Term`)
minors = minors %>% select(-`Enrolled Student Count`)
merged_data <- merge(merged_data, minors, by = c("Student.ID", "Term.Code"), all.x = TRUE, all.y = TRUE)
merged_data = merged_data %>% select(-`Cohort.Term.y`)
thematic <- read_excel("BA Major Students - Thematic Sequence ISA2.xlsx")
thematic <- thematic %>% rename(Student.ID = `Student ID`, Term.Code = `Term Code`, Thematic.Sequence.Title = `Thematic Sequence Title`)
thematic = thematic %>% select(-`Enrolled Student Count`)
merged_data <- merge(merged_data, thematic, by = c("Student.ID", "Term.Code"), all.x = TRUE, all.y = TRUE)
merged_data <- merged_data %>% group_by(Student.ID) %>% mutate (Flag = ifelse(n() < 8 & tail(Term.Code, 1) != '202410', 1,0)) %>% ungroup()
flagged = merged_data %>% filter(Flag == 1)
View(flagged)
merged_data <- merged_data %>% group_by(Student.ID) %>% mutate (Flag = ifelse(n() < 8 & tail(Term.Code, 1) != '202410' & any(merged_data == "BA Major"), 1,0)) %>% ungroup()
View(flagged)
# Read Excel files
file1 <- read.csv("Attributes.csv")
file1 = file1 %>% select(-`X`)
file2 <- read.csv("BA_Majors.csv")
file2 = file2 %>% select(-`X`)
# Combine data frames
merged_data <- merge(file1, file2, by = c("Student.ID", "Term.Code"))
# Write combined data frame to a new Excel file
saveRDS(merged_data, "StudentData")
count_table <- merged_data %>%
group_by(Term.Code) %>%
summarise(DistinctStudentCount = n_distinct(Student.ID))
# Print the new table
print(count_table)
minors <- read_excel("BA Major Students - Minors.xlsx")
minors <- minors %>% rename(Student.ID = `Student ID`, Term.Code = `Term Code`, Cohort.Term = `Cohort Term`)
minors = minors %>% select(-`Enrolled Student Count`)
merged_data <- merge(merged_data, minors, by = c("Student.ID", "Term.Code"), all.x = TRUE, all.y = TRUE)
merged_data = merged_data %>% select(-`Cohort.Term.y`)
thematic <- read_excel("BA Major Students - Thematic Sequence ISA2.xlsx")
thematic <- thematic %>% rename(Student.ID = `Student ID`, Term.Code = `Term Code`, Thematic.Sequence.Title = `Thematic Sequence Title`)
thematic = thematic %>% select(-`Enrolled Student Count`)
merged_data <- merge(merged_data, thematic, by = c("Student.ID", "Term.Code"), all.x = TRUE, all.y = TRUE)
merged_data <- merged_data %>% group_by(Student.ID) %>% mutate (Flag = ifelse(n() < 8 & tail(Term.Code, 1) != '202410', 1,0)) %>% ungroup()
flagged = merged_data %>% filter(Flag == 1)
merged_data <- merged_data %>% group_by(Student.ID) %>% mutate (Flag = ifelse(n() < 8 & tail(Term.Code, 1) != '202410',  & any(merged_data == "BA Major"), 1,0)) %>% ungroup()
merged_data <- merged_data %>% group_by(Student.ID) %>% mutate (Flag = ifelse(n() < 8 & tail(Term.Code, 1) != '202410'& any(merged_data == "BA Major"), 1,0)) %>% ungroup()
flagged = merged_data %>% filter(Flag == 1)
merged_data <- merged_data %>% group_by(Student.ID) %>% mutate (Flag = ifelse(n() < 8 & tail(Term.Code, 1) != '202410'& any(Major.1 == "BA Major", Major.2 == "BA Major"), 1,0)) %>% ungroup()
flagged = merged_data %>% filter(Flag == 1)
# Read Excel files
file1 <- read.csv("Attributes.csv")
file1 = file1 %>% select(-`X`)
file2 <- read.csv("BA_Majors.csv")
file2 = file2 %>% select(-`X`)
# Combine data frames
merged_data <- merge(file1, file2, by = c("Student.ID", "Term.Code"))
# Write combined data frame to a new Excel file
saveRDS(merged_data, "StudentData")
count_table <- merged_data %>%
group_by(Term.Code) %>%
summarise(DistinctStudentCount = n_distinct(Student.ID))
# Print the new table
print(count_table)
minors <- read_excel("BA Major Students - Minors.xlsx")
minors <- minors %>% rename(Student.ID = `Student ID`, Term.Code = `Term Code`, Cohort.Term = `Cohort Term`)
minors = minors %>% select(-`Enrolled Student Count`)
merged_data <- merge(merged_data, minors, by = c("Student.ID", "Term.Code"), all.x = TRUE, all.y = TRUE)
merged_data = merged_data %>% select(-`Cohort.Term.y`)
thematic <- read_excel("BA Major Students - Thematic Sequence ISA2.xlsx")
thematic <- thematic %>% rename(Student.ID = `Student ID`, Term.Code = `Term Code`, Thematic.Sequence.Title = `Thematic Sequence Title`)
thematic = thematic %>% select(-`Enrolled Student Count`)
merged_data <- merge(merged_data, thematic, by = c("Student.ID", "Term.Code"), all.x = TRUE, all.y = TRUE)
merged_data <- merged_data %>% group_by(Student.ID) %>% mutate (Flag = ifelse(n() < 8 & tail(Term.Code, 1) != '202410', 1,0)) %>% ungroup()
flagged = merged_data %>% filter(Flag == 1)
